<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>VO Invoice Generator</title>
  <style>
    /* ====== Basic Styles ====== */
    body {
      font-family: Arial, sans-serif;
      background: #f5f5f5;
      margin: 0;
      padding: 0;
    }
    .container {
      max-width: 900px;
      margin: 20px auto;
      background: #fff;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }
    h1 {
      text-align: center;
      color: #333;
    }
    input, select, textarea, button {
      width: 100%;
      padding: 8px 10px;
      margin: 5px 0 15px 0;
      border-radius: 6px;
      border: 1px solid #ccc;
      box-sizing: border-box;
    }
    label {
      font-weight: bold;
      display: block;
      margin-bottom: 5px;
    }
    .flex-row {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }
    .flex-row > div {
      flex: 1;
      min-width: 150px;
    }
    .toggle-label {
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .custom-items {
      margin-bottom: 15px;
    }
    .custom-item {
      display: flex;
      gap: 10px;
      margin-bottom: 5px;
    }
    .custom-item input {
      flex: 1;
    }
    button {
      background: #4CAF50;
      color: white;
      border: none;
      cursor: pointer;
    }
    button:hover {
      background: #45a049;
    }
    .invoice-preview {
      border-top: 2px dashed #ccc;
      padding-top: 15px;
      margin-top: 20px;
    }
    .invoice-preview h2 {
      margin-top: 0;
    }
    @media(max-width: 600px){
      .flex-row {
        flex-direction: column;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Voice-Over Invoice Generator</h1>

    <!-- ===== Invoice Basics ===== -->
    <div>
      <label>Client Name</label>
      <input type="text" id="clientName" placeholder="Enter client name">

      <label>Project Name</label>
      <input type="text" id="projectName" placeholder="Enter project name">

      <div class="flex-row">
        <div>
          <label>Invoice Date</label>
          <input type="date" id="invoiceDate">
        </div>
        <div>
          <label>Due Date</label>
          <input type="date" id="dueDate">
        </div>
      </div>
    </div>

    <!-- ===== VO-specific Toggles ===== -->
    <div>
      <h3>VO Options</h3>
      <label class="toggle-label">
        <input type="checkbox" id="usageRightsToggle">
        Usage Rights (web, TV, radio, internal)
      </label>
      <label class="toggle-label">
        <input type="checkbox" id="buyoutToggle">
        Buyout Option
      </label>
      <label class="toggle-label">
        <input type="checkbox" id="splitBillingToggle">
        Split Billing
      </label>
      <label class="toggle-label">
        <input type="checkbox" id="latePaymentToggle">
        Late Payment / Usage Activation Note
      </label>
    </div>

    <!-- ===== Custom Line Items ===== -->
    <div class="custom-items">
      <h3>Custom Line Items</h3>
      <div id="itemsContainer"></div>
      <button type="button" onclick="addItem()">+ Add Item</button>
    </div>

    <!-- ===== Notes / Clauses ===== -->
    <div>
      <label>Notes / Clauses</label>
      <textarea id="notes" rows="4" placeholder="Enter any notes or clauses here..."></textarea>
    </div>

    <!-- ===== Actions ===== -->
    <div class="flex-row">
      <button onclick="generateInvoice()">Generate Invoice</button>
      <button onclick="resetInvoice()" style="background:#f44336">Reset</button>
      <button onclick="duplicateInvoice()" style="background:#2196F3">Duplicate</button>
    </div>

    <!-- ===== Invoice Preview ===== -->
    <div class="invoice-preview" id="invoicePreview"></div>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script>
    // ===== Global Items Array =====
    let items = [];

    // ===== Add a new custom line item =====
    function addItem(label='', amount=''){
      const container = document.getElementById('itemsContainer');
      const div = document.createElement('div');
      div.className = 'custom-item';
      div.innerHTML = `
        <input type="text" placeholder="Item label" value="${label}" oninput="updateItemLabel(this)">
        <input type="number" placeholder="Amount" value="${amount}" oninput="updateItemAmount(this)">
        <button type="button" onclick="removeItem(this)">Remove</button>
      `;
      container.appendChild(div);
      items.push({label, amount});
    }

    function updateItemLabel(input){
      const index = [...input.parentNode.parentNode.children].indexOf(input.parentNode);
      items[index].label = input.value;
    }
    function updateItemAmount(input){
      const index = [...input.parentNode.parentNode.children].indexOf(input.parentNode);
      items[index].amount = parseFloat(input.value) || 0;
    }
    function removeItem(btn){
      const container = document.getElementById('itemsContainer');
      const index = [...container.children].indexOf(btn.parentNode);
      items.splice(index,1);
      container.removeChild(btn.parentNode);
    }

    // ===== Generate Invoice =====
    function generateInvoice(){
      const clientName = document.getElementById('clientName').value;
      const projectName = document.getElementById('projectName').value;
      const invoiceDate = document.getElementById('invoiceDate').value;
      const dueDate = document.getElementById('dueDate').value;

      const usageRights = document.getElementById('usageRightsToggle').checked ? 'Yes' : 'No';
      const buyout = document.getElementById('buyoutToggle').checked ? 'Yes' : 'No';
      const splitBilling = document.getElementById('splitBillingToggle').checked;
      const latePayment = document.getElementById('latePaymentToggle').checked ? 'Please pay before usage activation.' : '';

      const notes = document.getElementById('notes').value;

      // Calculate totals
      let total = 0;
      items.forEach(item => total += parseFloat(item.amount) || 0);

      // Build invoice HTML
      let html = `<h2>Invoice</h2>
                  <p><strong>Client:</strong> ${clientName}</p>
                  <p><strong>Project:</strong> ${projectName}</p>
                  <p><strong>Invoice Date:</strong> ${invoiceDate}</p>
                  <p><strong>Due Date:</strong> ${dueDate}</p>
                  <h3>VO Options</h3>
                  <p>Usage Rights: ${usageRights}</p>
                  <p>Buyout Option: ${buyout}</p>
                  <p>Split Billing: ${splitBilling ? 'Enabled' : 'No'}</p>
                  <p style="color:red">${latePayment}</p>
                  <h3>Line Items</h3>
                  <ul>`;
      items.forEach(item => html += `<li>${item.label}: $${item.amount}</li>`);
      html += `</ul>
               <h3>Total: $${total}</h3>
               <h3>Notes / Clauses</h3>
               <p>${notes}</p>
               <button onclick="downloadPDF()" style="margin-top:10px;">Download PDF</button>`;

      document.getElementById('invoicePreview').innerHTML = html;
    }

    // ===== Reset Invoice =====
    function resetInvoice(){
      document.getElementById('clientName').value = '';
      document.getElementById('projectName').value = '';
      document.getElementById('invoiceDate').value = '';
      document.getElementById('dueDate').value = '';
      document.getElementById('usageRightsToggle').checked = false;
      document.getElementById('buyoutToggle').checked = false;
      document.getElementById('splitBillingToggle').checked = false;
      document.getElementById('latePaymentToggle').checked = false;
      document.getElementById('notes').value = '';
      document.getElementById('itemsContainer').innerHTML = '';
      items = [];
      document.getElementById('invoicePreview').innerHTML = '';
    }

    // ===== Duplicate Invoice =====
    function duplicateInvoice(){
      const html = document.getElementById('invoicePreview').innerHTML;
      if(html) document.getElementById('invoicePreview').innerHTML += '<hr>' + html;
    }

    // ===== Download PDF =====
    function downloadPDF(){
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF();
      doc.html(document.getElementById('invoicePreview'), {
        callback: function(pdf){
          pdf.save('invoice.pdf');
        },
        x:10,
        y:10,
        width:180
      });
    }

    // ===== Default Template Values =====
    window.onload = () => {
      addItem('Voice-over Recording', 200);
      addItem('Editing & Processing', 50);
    }
  </script>
</body>
</html>
